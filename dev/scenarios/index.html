<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Alternative Scenarios · DSGE.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="DSGE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">DSGE.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../learning_how_to_use_dsgejl/">Learning How to Use DSGE.jl</a></li><li><a class="tocitem" href="../model_design/">Model Design</a></li><li><a class="tocitem" href="../special_model_types/">Special Model Types</a></li><li><a class="tocitem" href="../model_implementation_details/">Model Implementation Details</a></li><li><a class="tocitem" href="../running_existing_model/">Running An Existing Model</a></li><li><a class="tocitem" href="../input_data/">Input Data</a></li><li><a class="tocitem" href="../frbny_data/">FRBNY Model Input Data</a></li><li><a class="tocitem" href="../solving/">Solving the Model</a></li><li><a class="tocitem" href="../estimation/">Estimation</a></li><li><a class="tocitem" href="../forecast/">Forecasting</a></li><li><a class="tocitem" href="../irf/">Impulse Response Functions</a></li><li><a class="tocitem" href="../means_bands/">Computing Means and Bands</a></li><li><a class="tocitem" href="../altpolicy/">Alternative Policies</a></li><li class="is-active"><a class="tocitem" href>Alternative Scenarios</a><ul class="internal"><li><a class="tocitem" href="#Basic-Scenarios-1"><span>Basic Scenarios</span></a></li><li><a class="tocitem" href="#Additional-Features-1"><span>Additional Features</span></a></li><li><a class="tocitem" href="#Aggregating-Multiple-Scenarios-1"><span>Aggregating Multiple Scenarios</span></a></li></ul></li><li><a class="tocitem" href="../forecast_decomposition/">Forecast Decomposition</a></li><li><a class="tocitem" href="../plotting/">Plotting</a></li><li><a class="tocitem" href="../algorithms/">Algorithms</a></li><li><a class="tocitem" href="../advanced_usage/">Advanced Usage</a></li><li><a class="tocitem" href="../contributing/">Contributing to DSGE.jl</a></li><li><a class="tocitem" href="../MatlabToJuliaTransition/">MATLAB to Julia Transition: Estimation</a></li><li><a class="tocitem" href="../julia_forecasting/">MATLAB to Julia Transition: Forecast</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Alternative Scenarios</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Alternative Scenarios</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/FRBNY-DSGE/DSGE.jl/blob/master/docs/src/scenarios.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Alternative-Scenarios-1"><a class="docs-heading-anchor" href="#Alternative-Scenarios-1">Alternative Scenarios</a><a class="docs-heading-anchor-permalink" href="#Alternative-Scenarios-1" title="Permalink"></a></h1><p>An alternative scenario is a set of forecasted paths for a subset of observables (&quot;targets&quot;), along with a subset of shocks (&quot;instruments&quot;) which get the model to hit those paths. Each scenario has a description which tells a story about the scenario targets and instruments – for example, &quot;High Spreads&quot; or &quot;Persistent Consumer Optimism&quot;.</p><p>In an alternative scenario, we first solve for the values for specific shocks at specific horizons that create the paths of the observables imposed in the scenario. Only then do we run a regular forecast, imposing the path of shocks we just solved for and letting these propagate through the economy. (Compare to adding more periods of conditional data – in this case, the model is free to use as many shocks as it wants to explain the deviation of the conditional data from trend in these additional periods.) This allows us to answer questions like:</p><ul><li>Suppose a spread shock hits tomorrow, increasing spreads by 50 basis points. How large of a spread shock did this correspond to it? How does the economy respond? Suppose it is a discount factor shock instead.</li><li>Suppose a discount factor shock hits for the next two quarters, causing a 100 basis point increase in spreads for two quarters, then reverting to zero (increase from baseline).  How does the economy respond?</li></ul><p>We will conceive of all alternative scenario forecasts as occuring in &quot;deviations from baseline forecast&quot;. That is, if the scenario consists of spreads increasing by 50 basis points, then we want this to be independent of the underlying model and baseline forecast, such that in our own forecast, spreads actually are 50 basis points above our baseline forecast.</p><h2 id="Basic-Scenarios-1"><a class="docs-heading-anchor" href="#Basic-Scenarios-1">Basic Scenarios</a><a class="docs-heading-anchor-permalink" href="#Basic-Scenarios-1" title="Permalink"></a></h2><h3 id="The-Scenario-Type-1"><a class="docs-heading-anchor" href="#The-Scenario-Type-1">The <code>Scenario</code> Type</a><a class="docs-heading-anchor-permalink" href="#The-Scenario-Type-1" title="Permalink"></a></h3><p>The <code>Scenario</code> type encodes the basic information needed to forecast an alternative scenario. For now, we&#39;ll consider the following fields of the <code>Scenario</code> type:</p><ul><li><code>key::Symbol</code>: scenario identifier, appearing in file names</li><li><code>description::String</code>: longer name, e.g. &quot;High Spreads&quot;</li><li><code>target_names::Vector{Symbol}</code>: names of the observables targeted in this scenario. For the High Spreads scenario, this would just be <code>[:obs_spread]</code>. These observable names should correspond to keys in <code>m.observables</code></li><li><code>instrument_names::Vector{Symbol}</code>: names of the shocks used to hit the target paths, which should correspond to keys in <code>m.exogenous_shocks</code>. There must be at least as many instruments as there are targets. If this field is the empty array, then all model shocks will be used</li><li><code>targets::DataFrame</code>: contains the specific target values, <em>given in deviations from some baseline forecast</em>. No <code>:date</code> field is required, since the scenario is assumed to begin in the first forecasted period of the model</li><li><code>instruments::DataFrame</code>: initially empty <code>DataFrame</code>, which is populated after backing out the necessary shocks to hit the targets</li><li><code>vintage::String</code>: scenario vintage in <code>yymmdd</code> format, which can be different from the data vintage</li><li><code>n_draws::Int</code>: number of scenario draws. A scenario draw is one set of target paths. Often, multiple draws of target paths will be associated with one scenario name, which collectively make up a forecast distribution for the particular scenario. This field is usually initialized to 0 and then updated upon reading in the target draws</li></ul><h3 id="Setting-Up-Input-Target-Paths-1"><a class="docs-heading-anchor" href="#Setting-Up-Input-Target-Paths-1">Setting Up Input Target Paths</a><a class="docs-heading-anchor-permalink" href="#Setting-Up-Input-Target-Paths-1" title="Permalink"></a></h3><p>If you only want to forecast one scenario draw, it is sufficient to create an instance of the <code>Scenario</code> type and hard-code in the target paths. However, when forecasting multiple draws, it is convenient to load target draws from a file.</p><p>This file&#39;s name should be of the form <code>inpath(m, &quot;scenarios&quot;, &lt;key&gt;_&lt;vintage&gt;.jld)</code> and should contain the following datasets:</p><ul><li><code>arr::Array{Float64, 3}</code>: array of target values of size <code>ndraws</code> x <code>ntargets</code> x <code>horizon</code></li><li><code>target_indices::OrderedDict{Symbol, Int}</code>: maps target names to their indices along the <code>ntargets</code> dimension</li></ul><h3 id="Forecasting-Scenarios-1"><a class="docs-heading-anchor" href="#Forecasting-Scenarios-1">Forecasting Scenarios</a><a class="docs-heading-anchor-permalink" href="#Forecasting-Scenarios-1" title="Permalink"></a></h3><p>Forecasting scenarios is similar to running a normal full-distribution forecast, with some exceptions:</p><ul><li><p>All draws of a particular scenario are forecasted under the modal parameters.</p></li><li><p>Smoothed histories, shock decompositions, and IRFs are not supported.</p></li><li><p>We zero out the entries in the <span>$Q$</span> matrix (the variance-covariance of the shocks <span>$\epsilon_t$</span>) corresponding to shocks which are not scenario instruments.</p></li><li><p>Forecasting is done in deviations from baseline. That is, let <span>$s^a_t$</span> and <span>$s^b_t$</span> be the state vectors under the alternative and baseline scenarios respectively, and define <span>$y^a_t$</span> and <span>$y^b_t$</span> analogously for observable vectors. Then the state space in deviations is</p><div>\[\begin{aligned}
s^a_t - s^b_t &amp;= T(s^a_{t-1} - s^b_{t-1}) + R \epsilon_t &amp; \mathrm{(transition)} \\
y^a_t - y^b_t &amp;= Z(y^a_t - y^b_t) &amp; \mathrm{(measurement)}
\end{aligned}\]</div></li></ul><p>The main function to run is <code>forecast_scenario</code>, which is similar in spirit to <code>forecast_one</code>. <code>forecast_scenario</code> loads the modal parameters for the model and calls <code>forecast_scenario_draw</code>, which does the following for each input draw:</p><ol><li>Call <code>load_scenario_targets!</code> to read the <code>i</code>th scenario draw from the input file</li><li>Filter and smooth to back out the necessary shocks, treating the targeted paths like data</li><li>Forecast paths for all variables (not just the targeted observables) using the smoothed shocks</li><li>Check that the forecasted observables match the targets and return</li></ol><p>When all draws for the scenario have been forecasted, the forecasted observables and pseudo-observables are written to the files given by <code>get_scenario_output_files</code>.</p><h3 id="Computing-Means-and-Bands-1"><a class="docs-heading-anchor" href="#Computing-Means-and-Bands-1">Computing Means and Bands</a><a class="docs-heading-anchor-permalink" href="#Computing-Means-and-Bands-1" title="Permalink"></a></h3><p>Computing means and bands is carried out by <code>scenario_means_bands</code>, which is likewise similar to <code>compute_meansbands</code> for regular forecasts. The default <code>output_vars</code> passed into <code>scenario_means_bands</code> are</p><pre><code class="language-none">output_vars = [:forecastutobs, :forecastobs, :forecast4qobs,
               :forecastutpseudo, :forecastpseudo, :forecast4qpseudo]</code></pre><p>The product <code>:forecastut</code> refers to untransformed forecasts, i.e. forecasts in model units (in deviations from baseline).</p><p>Since these forecasts are given in deviations from baseline, different transformations are used than in the usual case. These don&#39;t add back population growth to per-capita variables and approximate annualizing log differences (exponentiating and raising to the fourth power) by multiplying by four. The mapping from usual to scenario transformation is given by <code>get_scenario_transform</code>.</p><h2 id="Additional-Features-1"><a class="docs-heading-anchor" href="#Additional-Features-1">Additional Features</a><a class="docs-heading-anchor-permalink" href="#Additional-Features-1" title="Permalink"></a></h2><h3 id="Other-Scenario-Fields-1"><a class="docs-heading-anchor" href="#Other-Scenario-Fields-1">Other <code>Scenario</code> Fields</a><a class="docs-heading-anchor-permalink" href="#Other-Scenario-Fields-1" title="Permalink"></a></h3><p>The remaining fields in the <code>Scenario</code> type are used to forecast scenarios using additional bells and whistles:</p><ul><li><code>shock_scaling::Float64</code>: after filtering and smoothing shocks, multiply them by <code>shock_scaling</code> before forecasting. Defaults to <code>1.0</code>.</li><li><code>draw_states::Bool</code>: if <code>true</code>, use the simulation smoother rather than the Kalman smoother to smooth shocks. This generates uncertainty around the target paths. Defaults to <code>false</code>.</li><li><code>altpolicy::AltPolicy</code>: solve for shocks under the historical policy rule, then switch to the alternative policy (see <a href="@ref">Alternative Policies</a>) before forecasting. Defaults to <code>AltPolicy(:historical, eqcond, solve)</code>.</li></ul><h3 id="SwitchingScenarios-1"><a class="docs-heading-anchor" href="#SwitchingScenarios-1"><code>SwitchingScenario</code>s</a><a class="docs-heading-anchor-permalink" href="#SwitchingScenarios-1" title="Permalink"></a></h3><p>Suppose you want to simulate a set of scenario draws which all start from some default scenario, switch to an alternative scenario (which we call the original scenario) with some probability in each period, and then revert back to the default scenario with some probability. This functionality is encoded in the <code>SwitchingScenario</code> type, which has the following fields:</p><ul><li><code>key::Symbol</code>: identifier, not the same as the original scenario&#39;s key</li><li><code>description::Symbol</code>: defaults to the original scenario&#39;s description</li><li><code>vintage::String</code>: defaults to the original scenario&#39;s vintage</li><li><code>original::SingleScenario</code></li><li><code>default::SingleScenario</code></li><li><code>probs_enter::Vector{Float64}</code>: gives the probability of leaving the default scenario and entering the original scenario in each period</li><li><code>probs_exit::Vector{Float64}</code>: gives the probability of leaving the original scenario and reverting to the default scenario in each period</li></ul><p><code>SingleScenario</code> is the abstract supertype of both <code>Scenario</code> and <code>SwitchingScenario</code>.</p><p><code>SwitchingScenario</code>s cannot be forecasted like ordinary <code>Scenario</code>s. Instead, after simulating draws from both the original and default scenarios, you call <code>simulate_switching</code> to use these already-forecasted draws. For each draw <code>i</code> of the original scenario:</p><ol><li>Randomly select a draw <code>j</code> of the default scenario.</li><li>In each period <code>t</code> (beginning in period 1), determine whether to switch to the original scenario with probability <code>probs_enter[t]</code>. If remaining in the default scenario, use the period <code>t</code> forecasted values of the <code>j</code>th default scenario draw.</li><li>Suppose the last period in the default scenario is <code>t0</code>. Then for each subsequent period <code>t0 + h</code>, decide whether to revert to the default scenario with probability <code>probs_exit[t0 + h]</code>. If remaining in the original scenario, use the period <code>h</code> (not <code>t0 + h</code>) forecasted values of the <code>i</code>th original scenario draw.</li><li>Let <code>t1</code> be the last period in the original scenario. Then for each remaining period <code>t1 + h</code>, use the period <code>t1 + h</code> forecasted values of the <code>j</code>th default scenario draw.</li></ol><p><code>simulate_switching</code> saves simulated draws in the same format as <code>forecast_scenario</code>. Transforming and computing means and bands for <code>SwitchingScenario</code>s using <code>scenario_means_bands</code> is the same as for regular <code>Scenario</code>s.</p><h2 id="Aggregating-Multiple-Scenarios-1"><a class="docs-heading-anchor" href="#Aggregating-Multiple-Scenarios-1">Aggregating Multiple Scenarios</a><a class="docs-heading-anchor-permalink" href="#Aggregating-Multiple-Scenarios-1" title="Permalink"></a></h2><p>Finally, we are sometimes interested in aggregating the forecast draws from multiple scenarios. We define the <code>ScenarioAggregate</code> type, which has the following fields:</p><ul><li><code>key::Symbol</code></li><li><code>description::String</code></li><li><code>scenarios::Vector{AbstractScenario}</code>: vector of component scenarios, <strong>some of which might be themselves <code>ScenarioAggregates</code></strong></li><li><code>sample::Bool</code>: indicates whether to</li><li><code>proportions::Vector{Float64}</code>: vector of relative scenario proportions</li><li><code>total_draws::Int</code>: desired final number of draws</li><li><code>replace::Bool</code>: indicates whether to sample with replacement</li><li><code>vintage::String</code></li></ul><p>In addition to the default constructor, there are two more <code>ScenarioAggregate</code> constructors, corresponding to the two possible values of <code>sample</code>. The key, description, vector of component scenarios, and vintage are always specified.</p><ul><li><code>sample = false</code>: No additional fields are required for this constructor, as the component scenario draws are kept in their original proportions. The <code>proportions</code> and <code>total_draws</code> fields are initialized to dummy values and are updated when the component draws are read in. <code>replace</code> is set to false.</li><li><code>sample = true</code>: Additionally specify <code>proportions</code>, <code>total_draws</code>, and <code>replace</code>. Draws from <code>scenarios[i]</code> are sampled into the aggregate distribution with probability <code>proportions[i]</code></li></ul><p><code>SingleScenario</code> and <code>ScenarioAggregate</code> are both subtypes of the abstract type <code>AbstractScenario</code>. The actual sampling and aggregating of scenario draws happens entirely in <code>scenario_means_bands</code>, which calls functions that dispatch on the <code>AbstractScenario</code> subtype passed in. In particular, this means that we don&#39;t save a separate &quot;raw&quot; output file with the individual draws that made it into a particular <code>ScenarioAggregate</code> – we only save the resulting <code>MeansBands</code>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../altpolicy/">« Alternative Policies</a><a class="docs-footer-nextpage" href="../forecast_decomposition/">Forecast Decomposition »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 24 August 2021 05:55">Tuesday 24 August 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

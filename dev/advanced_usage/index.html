<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Advanced Usage · DSGE.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="DSGE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">DSGE.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../model_design/">Model Design</a></li><li><a class="tocitem" href="../special_model_types/">Special Model Types</a></li><li><a class="tocitem" href="../running_existing_model/">Running An Existing Model</a></li><li class="is-active"><a class="tocitem" href>Advanced Usage</a><ul class="internal"><li><a class="tocitem" href="#Package-Directory-Structure"><span>Package Directory Structure</span></a></li><li><a class="tocitem" href="#Working-with-Settings"><span>Working with Settings</span></a></li><li><a class="tocitem" href="#regime-switch-forecast"><span>Regime-Switching Forecasts</span></a></li><li><a class="tocitem" href="#Automatically-Generating-Anticipated-Shocks"><span>Automatically Generating Anticipated Shocks</span></a></li><li><a class="tocitem" href="#editing-extending-model"><span>Editing or Extending a Model</span></a></li><li><a class="tocitem" href="#Additional-Tips"><span>Additional Tips</span></a></li></ul></li><li><a class="tocitem" href="../input_data/">Input Data</a></li><li><a class="tocitem" href="../frbny_data/">FRBNY Model Input Data</a></li><li><a class="tocitem" href="../implementation_details/">Implementation Details</a></li><li><a class="tocitem" href="../solving/">Solving the Model</a></li><li><a class="tocitem" href="../estimation/">Estimation</a></li><li><a class="tocitem" href="../forecast/">Forecasting</a></li><li><a class="tocitem" href="../irf/">Impulse Response Functions</a></li><li><a class="tocitem" href="../means_bands/">Computing Means and Bands</a></li><li><a class="tocitem" href="../altpolicy/">Alternative Policies</a></li><li><a class="tocitem" href="../scenarios/">Alternative Scenarios</a></li><li><a class="tocitem" href="../forecast_decomposition/">Forecast Decomposition</a></li><li><a class="tocitem" href="../plotting/">Plotting</a></li><li><a class="tocitem" href="../algorithms/">Algorithms</a></li><li><a class="tocitem" href="../contributing/">Contributing to DSGE.jl</a></li><li><a class="tocitem" href="../MatlabToJuliaTransition/">MATLAB to Julia Transition: Estimation</a></li><li><a class="tocitem" href="../julia_forecasting/">MATLAB to Julia Transition: Forecast</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Advanced Usage</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Advanced Usage</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/FRBNY-DSGE/DSGE.jl/blob/master/docs/src/advanced_usage.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="advanced-usage"><a class="docs-heading-anchor" href="#advanced-usage">Advanced Usage</a><a id="advanced-usage-1"></a><a class="docs-heading-anchor-permalink" href="#advanced-usage" title="Permalink"></a></h1><h2 id="Package-Directory-Structure"><a class="docs-heading-anchor" href="#Package-Directory-Structure">Package Directory Structure</a><a id="Package-Directory-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Package-Directory-Structure" title="Permalink"></a></h2><p>The package directory structure follows Julia module conventions. Directories in square brackets indicate future additions. <em>Note that this directory tree is not linked, although it appears to be.</em></p><ul><li><a href="../pkg_structure/#[DSGE.jl](https://github.com/FRBNY-DSGE/DSGE.jl)"><code>DSGE.jl</code></a></li><ul><li><a href="../pkg_structure/#doc/:-Code-and-model-documentation."><code>doc/</code>: Code and model documentation.</a></li><ul><li><a href="../pkg_structure/#examples/:-example-scripts"><code>examples/</code>: example scripts</a></li></ul><li><a href="../pkg_structure/#save/:-Sample-input-files;-default-input/output-directories."><code>save/</code>: Sample input files; default input/output directories.</a></li><li><a href="../pkg_structure/#src/"><code>src/</code></a></li><ul><li><a href="../pkg_structure/#DSGE.jl:-The-main-module-file."><code>DSGE.jl</code>: The main module file.</a></li><li><a href="../pkg_structure/#abstractdsgemodel.jl:-Defines-the-AbstractModel-type."><code>abstractdsgemodel.jl</code>: Defines the <code>AbstractModel</code> type.</a></li><li><a href="../pkg_structure/#abstractvarmodel.jl:-Defines-the-AbstractVARModel,-AbstractDSGEVARModel,-and-AbstractDSGEVECMModel-types."><code>abstractvarmodel.jl</code>: Defines the <code>AbstractVARModel</code>, <code>AbstractDSGEVARModel</code>, and <code>AbstractDSGEVECMModel</code> types.</a></li><li><a href="../pkg_structure/#defaults.jl:-Default-settings-for-models."><code>defaults.jl</code>: Default settings for models.</a></li><li><a href="../pkg_structure/#statespace.jl:-Defines-types-and-functions-for-computing-the-state-space-representation-of-models."><code>statespace.jl</code>: Defines types and functions for computing the state-space representation of models.</a></li><li><a href="../pkg_structure/#data/:-Manipulating-and-updating-input-dataset."><code>data/</code>: Manipulating and updating input dataset.</a></li><li><a href="../pkg_structure/#solve/:-Solving-the-model;-includes-gensys.jl-code."><code>solve/</code>: Solving the model; includes <code>gensys.jl</code> code.</a></li><li><a href="../pkg_structure/#estimate/:-Optimization,-posterior-sampling,-and-other-functionality."><code>estimate/</code>: Optimization, posterior sampling, and other functionality.</a></li><li><a href="../pkg_structure/#forecast/:-Forecasts,-smoothing,-shock-decompositions,-and-impulse-response-functions."><code>forecast/</code>: Forecasts, smoothing, shock decompositions, and impulse response functions.</a></li><li><a href="../pkg_structure/#decomp/:-Decompose-changes-in-forecasts-into-three-reasons:-new-data,-data-revisions,-and-changes-in-the-calibration."><code>decomp/</code>: Decompose changes in forecasts into three reasons: new data, data revisions, and changes in the calibration.</a></li><li><a href="../pkg_structure/#analysis/:-Moment-tables-of-estimated-parameters,-computation-of-forecast-means-and-bands."><code>analysis/</code>: Moment tables of estimated parameters, computation of forecast means and bands.</a></li><li><a href="../pkg_structure/#altpolicy/:-Infrastructure-for-forecasting-under-alternative-monetary-policy-rules."><code>altpolicy/</code>: Infrastructure for forecasting under alternative monetary policy rules.</a></li><li><a href="../pkg_structure/#scenarios/:-Forecasting-alternative-scenarios."><code>scenarios/</code>: Forecasting alternative scenarios.</a></li><li><a href="../pkg_structure/#plot/:-Plot-estimation-results,-forecasts,-etc."><code>plot/</code>: Plot estimation results, forecasts, etc.</a></li><li><a href="../pkg_structure/#packet/:-Automatically-generate-documents-with-results-from-forecasts-and-estimations."><code>packet/</code>: Automatically generate documents with results from forecasts and estimations.</a></li><li><a href="../pkg_structure/#models/"><code>models/</code></a></li><ul><li><a href="../pkg_structure/#representative/:-Representative-agent-models."><code>representative/</code>: Representative agent models.</a></li><ul><li><a href="../pkg_structure/#m990/:-Contains-code-to-define-and-initialize-version-990-of-the-New-York-Fed-DSGE-model."><code>m990/</code>: Contains code to define and initialize version 990 of the New York Fed DSGE model.</a></li><li><a href="../pkg_structure/#[[m991/]]:-Code-for-new-models-should-be-kept-in-directories-at-this-level-in-the-directory-tree">[<code>[m991/]</code>]: Code for new models should be kept in directories at this level in the directory tree</a></li></ul><li><a href="../pkg_structure/#heterogeneous/:-Heterogeneous-agent-models"><code>heterogeneous/</code>: Heterogeneous agent models</a></li><li><a href="../pkg_structure/#poolmodel/:-PoolModel-type-for-model-averaging."><code>poolmodel/</code>: PoolModel type for model averaging.</a></li><li><a href="../pkg_structure/#var/:-DSGE-VAR-and-DSGE-VECM-models."><code>var/</code>: DSGE-VAR and DSGE-VECM models.</a></li></ul></ul><li><a href="../pkg_structure/#test/:-Module-test-suite."><code>test/</code>: Module test suite.</a></li></ul></ul><h2 id="Working-with-Settings"><a class="docs-heading-anchor" href="#Working-with-Settings">Working with Settings</a><a id="Working-with-Settings-1"></a><a class="docs-heading-anchor-permalink" href="#Working-with-Settings" title="Permalink"></a></h2><p>There are many computational settings that affect how the code runs without affecting the mathematical definition of the model. While the default settings loaded are intended to be comprehensive rather than the minimal number of settings, users will generally want to check that these three settings are properly chosen:</p><ul><li><code>saveroot::String</code>: The root directory for model output.</li><li><code>dataroot::String</code>: The root directory for model input data.</li><li><code>data_vintage::String</code>: Data vintage, formatted <code>yymmdd</code>. By default, <code>data_vintage</code> is set to today&#39;s date. It is (currently) the only setting printed to output filenames by default.</li></ul><p>Many functions in DSGE.jl will either require input data or create output data, so it is important to check that the saveroot and dataroot are set as the user intends. Setting the data vintage is also useful for reproducibility. Economic data like GDP are frequently revised, which can pose issues for reproducing results. Setting the data vintage allows users to guarantee the correct vintage of data is used when generating results. By default, the data vintage is set to the current date, so a user will need to manually set the data vintage to the desired date.</p><p>Below, we describe several important settings for package usage.</p><p>For more details on implementation and usage of settings, see <a href="https://github.com/FRBNY-DSGE/ModelConstructors.jl">ModelConstructors.jl</a>.</p><p>See <a href="https://github.com/FRBNY-DSGE/DSGE.jl/blob/master/src/defaults.jl">defaults.jl</a> for the complete description of default settings.</p><h4 id="General"><a class="docs-heading-anchor" href="#General">General</a><a id="General-1"></a><a class="docs-heading-anchor-permalink" href="#General" title="Permalink"></a></h4><ul><li><code>saveroot::String</code>: The root directory for model output.</li><li><code>use_parallel_workers::Bool</code>: Use available parallel workers in computations.</li><li><code>nominal_rate_observable</code>: Name (as a <code>Symbol</code>) of the observable used to measure the nominal interest rate used to implement monetary policy.</li><li><code>monetary_policy_shock</code>: Name (as a <code>Symbol</code>) of the exogenous monetary policy shock in a concrete subtype of <code>AbstractDSGEModel</code>.</li><li><code>n_mon_anticipated_shocks::Int</code>: Number of anticipated policy shocks.</li><li><code>antshocks::Dict{Symbol, Int}</code>: a dictionary mapping the name of an anticipated shock to the number of periods of anticipation, e.g. <code>:b =&gt; 2</code> adds anticipated <code>b</code> shocks up to two periods ahead.</li><li><code>ant_eq_mapping::Dict{Symbol, Symbol}</code>: a dictionary mapping the name of an anticipated shock to the name of the state variable in the equation defining the shock&#39;s exogenous process, e.g. <code>:b =&gt; :b</code> maps an anticipated <code>b</code> shock to the equation <code>eq_b</code>.</li><li><code>ant_eq_E_mapping::Dict{Symbol, Symbol}</code>: a dictionary mapping the name of an anticipated shock to the name of the state variable in the equation defining the shock&#39;s one-period ahead expectation e.g. <code>:b =&gt; :Eb</code>  maps an anticipated <code>b</code> shock to the equation <code>eq_Eb</code>, where <code>Eb</code> is <span>$E_t[b_{t + 1}]$</span>.</li><li><code>proportional_antshocks::Vector{Symbol}</code>: a vector of the names of one-period ahead anticipated shocks which are specified as directly proportional to the realizations of the current period&#39;s unanticipated shocks. For a shock <code>b</code>, the automatically generated parameter <code>σ_b_prop</code> defines the proportionality to the current period shock, e.g. a value of 1 indicates an anticipated shock in the next period of the same size as the current period&#39;s unanticipated shock.</li></ul><h4 id="Data-and-I/O"><a class="docs-heading-anchor" href="#Data-and-I/O">Data and I/O</a><a id="Data-and-I/O-1"></a><a class="docs-heading-anchor-permalink" href="#Data-and-I/O" title="Permalink"></a></h4><ul><li><code>dataroot::String</code>: The root directory for model input data.</li><li><code>data_vintage::String</code>: Data vintage, formatted <code>yymmdd</code>. By default, <code>data_vintage</code> is set to today&#39;s date. It is (currently) the only setting printed to output filenames by default.</li><li><code>dataset_id::Int</code>: Dataset identifier. There should be a unique dataset ID for each set of observables.</li><li><code>cond_vintage::String</code>: Conditional data vintage, formatted <code>yymmdd</code>.</li><li><code>cond_id::Int</code>: Conditional dataset identifier. There should be a unique conditional dataset ID for each set of input, raw data mnemonics (not observables!).</li><li><code>cond_semi_names::Vector{Symbol}</code> and <code>cond_full_names::Vector{Symbol}</code>: names of observables for which we want to use semi- and full conditional data. All other observables are <code>NaN</code>ed out in the conditional data periods.</li><li><code>population_mnemonic::Nullable{Symbol}</code>: population series mnemonic in form <code>Nullable(:&lt;mnemonic&gt;__&lt;source&gt;)</code> (for example, <code>Nullable(:CNP16OV__FRED)</code>), or <code>Nullable{Symbol}()</code> if the model doesn&#39;t use population data</li></ul><h4 id="Dates"><a class="docs-heading-anchor" href="#Dates">Dates</a><a id="Dates-1"></a><a class="docs-heading-anchor-permalink" href="#Dates" title="Permalink"></a></h4><ul><li><code>date_presample_start::Date</code>: Start date of pre-sample.</li><li><code>date_mainsample_start::Date</code>: Start date of main sample.</li><li><code>date_zlb_start::Date</code>: Start date of zero lower bound regime.</li><li><code>date_zlb_end::Date</code>: End date of zero lower bound regime.</li><li><code>date_forecast_start::Date</code>: Start date of forecast period (or the period after the last period for which we have GDP data).</li><li><code>date_forecast_end::Date</code>: End date of forecast, i.e. how far into the future to forecast.</li><li><code>date_conditional_end::Date</code>: Last date for which we have conditional data. This is typically the same as <code>date_forecast_start</code> when we condition on nowcasts and current quarter financial data.</li></ul><h4 id="Estimation"><a class="docs-heading-anchor" href="#Estimation">Estimation</a><a id="Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Estimation" title="Permalink"></a></h4><h5 id="Metropolis-Hastings-Settings"><a class="docs-heading-anchor" href="#Metropolis-Hastings-Settings">Metropolis-Hastings Settings</a><a id="Metropolis-Hastings-Settings-1"></a><a class="docs-heading-anchor-permalink" href="#Metropolis-Hastings-Settings" title="Permalink"></a></h5><ul><li><code>reoptimize::Bool</code>: Whether to reoptimize the posterior mode. If <code>true</code> (the   default), <code>estimate</code> begins reoptimizing from the model object&#39;s parameter   vector.  See <a href="../estimation/#estimation-reoptimizing">Optimizing or Reoptimizing</a> for   more details.</li><li><code>calculate_hessian::Bool</code>: Whether to compute the Hessian. If <code>true</code> (the   default), <code>estimate</code> calculates the Hessian at the posterior mode.</li><li><code>n_mh_simulations::Int</code>: Number of draws from the posterior distribution per block.</li><li><code>n_mh_blocks::Int</code>: Number of blocks to run Metropolis-Hastings.</li><li><code>n_mh_burn::Int</code>: Number of blocks to discard as burn-in for Metropolis-Hastings.</li><li><code>mh_thin::Int</code>: Metropolis-Hastings thinning step.</li><li><code>parallel::Bool</code>: Flag for running algorithm in parallel.</li><li><code>n_parts::Int</code>: Number of particles.</li><li><code>n_blocks::Int</code>: Number of parameter blocks in mutation step.</li><li><code>n_mh_steps::Int</code>: Number of Metropolis Hastings steps to attempt during the mutation step.</li></ul><h5 id="Sequential-Monte-Carlo-Settings"><a class="docs-heading-anchor" href="#Sequential-Monte-Carlo-Settings">Sequential Monte Carlo Settings</a><a id="Sequential-Monte-Carlo-Settings-1"></a><a class="docs-heading-anchor-permalink" href="#Sequential-Monte-Carlo-Settings" title="Permalink"></a></h5><ul><li><p><code>λ::S</code>: The &#39;bending coefficient&#39; λ in Φ(n) = (n/N(Φ))^λ</p></li><li><p><code>n_Φ::Int</code>: Number of stages in the tempering schedule.</p></li><li><p><code>resampling_method::Symbol</code>: Which resampling method to use.</p><ul><li><code>:systematic</code>: Will use sytematic resampling.</li><li><code>:multinomial</code>: Will use multinomial resampling.</li><li><code>:polyalgo</code>: Samples using a polyalgorithm.</li></ul></li><li><p><code>threshold_ratio::S</code>: Threshold s.t. particles will be resampled when the population   drops below threshold * N</p></li><li><p><code>c::S</code>: Scaling factor for covariance of the particles. Controls size of steps in mutation step.</p></li><li><p><code>α::S</code>: The mixture proportion for the mutation step&#39;s proposal distribution.</p></li><li><p><code>target::S</code>: The initial target acceptance rate for new particles during mutation.</p></li><li><p><code>use_chand_recursion::Bool</code>: Flag for using Chandrasekhar Recursions in Kalman filter.</p></li><li><p><code>use_fixed_schedule::Bool</code>: Flag for whether or not to use a fixed tempering (ϕ) schedule.</p></li><li><p><code>tempering_target::S</code>: Coefficient of the sample size metric to be targeted when solving   for an endogenous ϕ.</p></li><li><p><code>old_data::Matrix{S}</code>:</p></li><li><p><code>old_cloud::ParticleCloud</code>:</p></li><li><p><code>old_vintage::String</code>: String for vintage date of old data</p></li><li><p><code>smc_iteration::Int</code>: The iteration index for the number of times SMC has been run on the    same data vintage. Primarily for numerical accuracy/testing purposes.</p></li><li><p><code>run_test::Bool</code>: Flag for when testing accuracy of program</p></li><li><p><code>filestring_addl::Vector{String}</code>: Additional file string extension for loading old cloud.</p></li><li><p><code>continue_intermediate::Bool</code>: Flag to indicate whether one is continuing SMC from an   intermediate stage/</p></li><li><p><code>intermediate_stage_start::Int</code>: Intermediate stage at which one wishes to begin the estimation.</p></li><li><p><code>save_intermediate::Bool</code>: Flag for whether one wants to save intermediate Cloud objects</p></li><li><p><code>intermediate_stage_increment::Int</code>: Save Clouds at every increment   (1 = each stage, 10 = every 10th stage, etc.)</p></li></ul><h4 id="Forecasting"><a class="docs-heading-anchor" href="#Forecasting">Forecasting</a><a id="Forecasting-1"></a><a class="docs-heading-anchor-permalink" href="#Forecasting" title="Permalink"></a></h4><ul><li><code>forecast_jstep::Int</code>: Forecast thinning step.</li><li><code>forecast_block_size::Int</code>: Number of draws in each forecast block <em>before</em> thinning by <code>forecast_jstep</code>.</li><li><code>forecast_input_file_overrides::Dict{Symbol, String}</code>: Maps <code>input_type</code>(s) to the file name containing input draws for that type of forecast. See <a href="#Forecasting">Forecasting</a>.</li><li><code>forecast_horizons::Int</code>: Number of periods to forecast.</li><li><code>impulse_response_horizons::Int</code>: Number of periods for which to calculate IRFs.</li><li><code>n_periods_no_shocks::Int</code>: Number of periods for which no shocks are drawn (e.g. a full-distribution forecast draws shocks, but if <code>n_periods_no_shocks = 3</code>, then for 3 periods in the forecast horizon, no shocks will be drawn)</li></ul><h4 id="Alternative-Policy"><a class="docs-heading-anchor" href="#Alternative-Policy">Alternative Policy</a><a id="Alternative-Policy-1"></a><a class="docs-heading-anchor-permalink" href="#Alternative-Policy" title="Permalink"></a></h4><ul><li><code>alternative_policy::AltPolicy</code>: See <a href="../altpolicy/#Alternative-Policies">Alternative Policies</a>.</li></ul><h3 id="Accessing-Settings"><a class="docs-heading-anchor" href="#Accessing-Settings">Accessing Settings</a><a id="Accessing-Settings-1"></a><a class="docs-heading-anchor-permalink" href="#Accessing-Settings" title="Permalink"></a></h3><p>The function <code>get_setting(m::AbstractModel, s::Symbol)</code> returns the value of the setting <code>s</code> in <code>m.settings</code>. Some settings also have explicit getter methods that take only the model object <code>m</code> as an argument. Note that not all are exported.</p><h3 id="Overwriting-Default-Settings"><a class="docs-heading-anchor" href="#Overwriting-Default-Settings">Overwriting Default Settings</a><a id="Overwriting-Default-Settings-1"></a><a class="docs-heading-anchor-permalink" href="#Overwriting-Default-Settings" title="Permalink"></a></h3><p>To overwrite default settings added during model construction, a user must create a <code>Dict{Symbol, Setting}</code> and pass that into the model constructor as the keyword argument <code>custom_settings</code>. If the <code>print</code>, <code>code</code>, and <code>description</code> fields of the new <code>Setting</code> object are not provided, the fields of the existing setting will be maintained. If new values for <code>print</code>, <code>code</code>, and <code>description</code> are specified, and if these new values are distinct from the defaults for those fields, the fields of the existing setting will be updated.</p><p>For example, overwriting <code>use_parallel_workers</code> should look like this:</p><pre><code class="language-julia">custom_settings = Dict{Symbol, Setting}(
    :use_parallel_workers =&gt; Setting(:use_parallel_workers, true))
m = Model990(custom_settings = custom_settings)</code></pre><p>Or like this:</p><pre><code class="language-julia">m = Model990()
m &lt;= Setting(:use_parallel_workers, true)</code></pre><p>Note that using this second method will not work for all settings, e.g. <code>n_anticipated_shocks</code> is a setting that must be passed into the model during construction, as in the first example.</p><p>By default, passing in <code>custom_settings</code> overwrites the entries in the model object&#39;s <code>settings</code> field. However, with the additional keyword argument <code>testing = true</code>, it will overwrite the entries in <code>test_settings</code>:</p><pre><code class="language-julia">m = Model990(custom_settings = custom_settings, testing = true)</code></pre><h2 id="regime-switch-forecast"><a class="docs-heading-anchor" href="#regime-switch-forecast">Regime-Switching Forecasts</a><a id="regime-switch-forecast-1"></a><a class="docs-heading-anchor-permalink" href="#regime-switch-forecast" title="Permalink"></a></h2><p>Forecasts can involve state-space systems with exogenous and unanticipated regime-switching in the history periods and forecast horizon. Anticipated temporary alternative policies can also occur in the forecast horizon. Historical regime switching may occur to reflect structural breaks or to allow a DSGE to handle special circumstances, such as the COVID-19 pandemic. Regime switches in the forecast horizon may occur because of temporary alternative policies. In a rational expectations equilibrium, agents will behave differently if they know a forecasted policy is temporary rather than permanent. Using exogenous regime-switching along with a modified <code>gensys</code> solution algorithm is one way of implementing this expectation.</p><p>In this section, we will go over the interface for running regime-switching forecasts and discuss some details of the implementation. It is useful to also look at the posted <a href="https://github.com/FRBNY-DSGE/DSGE.jl/blob/master/docs/examples/regime_switching.jl">example script</a> for regime-switching. To understand how to implement your own regime-switching model, we recommend examining the implementation of <a href="https://github.com/FRBNY-DSGE/DSGE.jl/blob/master/src/models/representative/m1002/eqcond.jl">regime-switching equilibrium conditions</a> for <code>Model1002</code> and how it is integrated with our <a href="https://github.com/FRBNY-DSGE/DSGE.jl/blob/master/src/solve/solve.jl">solvers</a>. For a guide to running temporary alternative policies, please see <a href="../altpolicy/#Alternative-Policies">Alternative Policies</a>.</p><h3 id="Preparing-a-Model&#39;s-Settings-for-Regime-Switching"><a class="docs-heading-anchor" href="#Preparing-a-Model&#39;s-Settings-for-Regime-Switching">Preparing a Model&#39;s Settings for Regime-Switching</a><a id="Preparing-a-Model&#39;s-Settings-for-Regime-Switching-1"></a><a class="docs-heading-anchor-permalink" href="#Preparing-a-Model&#39;s-Settings-for-Regime-Switching" title="Permalink"></a></h3><p>Suppose we wanted to run a regime-switching forecast, where where the regimes are 1959:Q3-1989:Q4, 1990:Q1-2019:Q3, and 2019:Q4 to the end of the forecast horizon. The following lines are required:</p><pre><code class="language-none">m &lt;= Setting(:regime_switching, true)
m &lt;= Setting(:regime_dates, Dict{Int, Date}(1 =&gt; Date(1959, 9, 30), 2 =&gt; Date(1990, 3, 31),
                                            3 =&gt; Date(2019, 12, 31))</code></pre><p>The first setting turns on regime switching. Internally, functions like <code>forecast_one</code> will decide whether to use regime switching or not depending on whether <code>get_setting(m, :regime_switching)</code> is true and whether there are actually multiple regimes specified by <code>:regime_dates</code>. The second setting is a <code>Dict</code> mapping the regime number to the first date (inclusive) of that regime.</p><p>Before running a forecast, we must also run</p><pre><code class="language-none">setup_regime_switching_inds!(m)</code></pre><p>which will automatically compute the (required) settings</p><ul><li><code>:reg_forecast_start</code>: Regime of the first forecast start period</li><li><code>:reg_post_conditional_end</code>: Regime of the period after the last conditional forecast period</li><li><code>:n_regimes</code>: Number of total regimes. If this is 1, then regime switching will not occur.</li><li><code>:n_hist_regimes</code>: Number of regimes in the history</li><li><code>:n_fcast_regimes</code>: Number of regimes in the forecast horizon (including the conditional forecast)</li><li><code>:n_cond_regimes</code>: Number of regimes in the conditional forecast</li></ul><p>Finally, to run a full-distribution forecast with regime-switching using <code>forecast_one</code> or <code>usual_model_forecast</code>, it is necessary to manually construct the matrix of parameter draws and pass them as an input with the keyword <code>params</code>. Currently, we have not fully implemented loading parameters from a saved estimation file. For an example about how to do this, see this <a href="https://github.com/FRBNY-DSGE/DSGE.jl/blob/master/docs/examples/regime_switching.jl">example script</a>.</p><h3 id="Available-Types-of-Regime-Switching"><a class="docs-heading-anchor" href="#Available-Types-of-Regime-Switching">Available Types of Regime Switching</a><a id="Available-Types-of-Regime-Switching-1"></a><a class="docs-heading-anchor-permalink" href="#Available-Types-of-Regime-Switching" title="Permalink"></a></h3><p>There are two cases involving regime switching that are implemented in DSGE.jl</p><ul><li>Regime switching parameters</li><li>Temporary alternative policies</li></ul><p>To implement regime-switching parameters, see the <a href="https://github.com/FRBNY-DSGE/DSGE.jl/blob/master/docs/examples/regime_switching.jl">example script</a> for a regime-switching forecast. For further details, see the <a href="https://github.com/FRBNY-DSGE/ModelConstructors.jl">documentation for ModelConstructors.jl</a>, which implements regime-switching parameters.</p><p>Once the regime-switching settings are properly created, the syntax for running a forecast is the same as when there is no regime-switching. See <a href="#Forecasting">Forecasting</a>.</p><h3 id="Handling-of-the-Zero-Lower-Bound-(ZLB)"><a class="docs-heading-anchor" href="#Handling-of-the-Zero-Lower-Bound-(ZLB)">Handling of the Zero Lower Bound (ZLB)</a><a id="Handling-of-the-Zero-Lower-Bound-(ZLB)-1"></a><a class="docs-heading-anchor-permalink" href="#Handling-of-the-Zero-Lower-Bound-(ZLB)" title="Permalink"></a></h3><p>Technically speaking, the New York Fed DSGE model handles the ZLB as a separate regime in which anticipated monetary policy shocks become &quot;alive&quot; and have positive standard deviations. However, the ZLB is not implemented as a separate regime. The reason is the only difference in the &quot;pre-ZLB&quot; and &quot;post-ZLB&quot; regimes is whether or not anticipated monetary policy shocks are non-zero. For an example, see the <a href="https://github.com/FRBNY-DSGE/DSGE.jl/blob/master/src/forecast/smooth.jl">smoothing code</a> as well as the auxiliary functions <code>zlb_regime_matrices</code> and <code>zlb_regime_indices</code> in this <a href="https://github.com/FRBNY-DSGE/DSGE.jl/blob/master/src/estimate/kalman.jl">file</a>.</p><p>This approach saves computational time. Rather than creating redundant matrices, we directly zero/un-zero the appropriate entries in the pre- and post-ZLB <code>QQ</code> matrices. This approach also economizes on unnecessary switching, For instance, during the calculation of shock decompositions and trends, it is unnecessary to distinguish between the pre- and post-ZLB regimes.</p><h2 id="Automatically-Generating-Anticipated-Shocks"><a class="docs-heading-anchor" href="#Automatically-Generating-Anticipated-Shocks">Automatically Generating Anticipated Shocks</a><a id="Automatically-Generating-Anticipated-Shocks-1"></a><a class="docs-heading-anchor-permalink" href="#Automatically-Generating-Anticipated-Shocks" title="Permalink"></a></h2><p>We have implemented some functionality for automatically adding anticipated shocks for <code>Model1002</code>. To add these shocks, the user must pass custom settings into the constructor using the <code>custom_settings</code> keyword. The available settings for defining these shocks are:</p><ul><li><code>antshocks::Dict{Symbol, Int}</code>: a dictionary mapping the name of an anticipated shock to the number of periods of anticipation, e.g. <code>:b =&gt; 2</code> adds anticipated <code>b</code> shocks up to two periods ahead.</li><li><code>ant_eq_mapping::Dict{Symbol, Symbol}</code>: a dictionary mapping the name of an anticipated shock to the name of the state variable in the equation defining the shock&#39;s exogenous process, e.g. <code>:b =&gt; :b</code> maps an anticipated <code>b</code> shock to the equation <code>eq_b</code>.</li><li><code>ant_eq_E_mapping::Dict{Symbol, Symbol}</code>: a dictionary mapping the name of an anticipated shock to the name of the state variable in the equation defining the shock&#39;s one-period ahead expectation e.g. <code>:b =&gt; :Eb</code>  maps an anticipated <code>b</code> shock to the equation <code>eq_Eb</code>, where <code>Eb</code> is <span>$E_t[b_{t + 1}]$</span>.</li><li><code>proportional_antshocks::Vector{Symbol}</code>: a vector of the names of one-period ahead anticipated shocks which are specified as directly proportional to the realizations of the current period&#39;s unanticipated shocks. For a shock <code>b</code>, the automatically generated parameter <code>σ_b_prop</code> defines the proportionality to the current period shock, e.g. a value of 1 indicates an anticipated shock in the next period of the same size as the current period&#39;s unanticipated shock.</li></ul><p>As an example, the following code creates an instance of <code>Model1002</code> with anticipation of <code>b</code> shocks up to two periods ahead.</p><pre><code class="language-none">custom_settings = Dict{Symbol, Setting}(:antshocks =&gt; Setting(:antshocks, Dict{Symbol, Int}(:b =&gt; 2)),
                :ant_eq_mapping =&gt; Setting(:ant_eq_mapping, Dict{Symbol, Symbol}(:b =&gt; :b)))
m = Model1002(&quot;ss10&quot;; custom_settings = custom_settings)</code></pre><h2 id="editing-extending-model"><a class="docs-heading-anchor" href="#editing-extending-model">Editing or Extending a Model</a><a id="editing-extending-model-1"></a><a class="docs-heading-anchor-permalink" href="#editing-extending-model" title="Permalink"></a></h2><p>Users may want to extend or edit <code>Model990</code> in a number of different ways.  The most common changes are listed below, in decreasing order of complexity:</p><ol><li>Add new parameters</li><li>Modify equilibrium conditions or measurement equations</li><li>Change the values of various parameter fields (i.e. initial <code>value</code>, <code>prior</code>, <code>transform</code>, etc.)</li><li>Change the values of various computational settings (i.e. <code>reoptimize</code>, <code>n_mh_blocks</code>)</li></ol><p>Points 1 and 2 often go together (adding a new parameter guarantees a change in equilibrium conditions), and are such fundamental changes that they increment the model specification number and require the definition of a new subtype of <code>AbstractModel</code> (for instance, <code>Model991</code>).  See <a href="#model-specification-mspec">Model specification</a> for more details.</p><p>Any changes to the initialization of preexisting parameters are defined as a new model <em>sub-specification</em>, or <em>subspec</em>. While less significant than a change to the model&#39;s equilibrium conditions, changing the values of some parameter fields (especially priors) can have economic significance over and above settings we use for computational purposes. <strong>Parameter definitions should not be modified in the model object&#39;s constructor.</strong> First, incrementing the model&#39;s sub-specification number when parameters are changed improves model-level (as opposed to code-level) version control. Second, it avoids potential output filename collisions, preventing the user from overwriting output from previous estimations with the original parameters. The protocol for defining new sub-specifications is described in <a href="#model-sub-specifications-msubspec">Model sub-specifications</a>.</p><h3 id="model-specification-mspec"><a class="docs-heading-anchor" href="#model-specification-mspec">Model specification (<code>m.spec</code>)</a><a id="model-specification-mspec-1"></a><a class="docs-heading-anchor-permalink" href="#model-specification-mspec" title="Permalink"></a></h3><p>A particular model, which corresponds to a subtype of <code>AbstractModel</code>, is defined as a set of parameters, equilibrium conditions (defined by the <code>eqcond</code> function) and measurement equations (defined by the <code>measurement</code> function).  Therefore, the addition of new parameters, states, or observables, or any changes to the equilibrium conditions or measurement equations necessitate the creation of a new subtype of <code>AbstractModel.</code></p><p>To create a new model object, we recommend doing the following:</p><ol><li>Duplicate the <code>m990</code> directory within the <a href="https://github.com/FRBNY-DSGE/DSGE.jl/tree/master/src/models">models</a> directory. Name the new directory <code>mXXX.jl</code>, where <code>XXX</code> is your chosen model specification number or string. Rename <code>m990.jl</code> in this directory to <code>mXXX.jl</code>.</li><li>In the <code>mXXX/</code> directory, change all references to <code>Model990</code> to <code>ModelXXX</code>.</li><li>Edit the <code>m990.jl</code>, <code>eqcond.jl</code>, and <code>measurement.jl</code> files as you see fit.  If adding new states, equilibrium conditions, shocks, or observables, be sure to add them to the appropriate list in <code>init_model_indices</code>.</li><li>Open the module file, <code>src/DSGE.jl</code>. Add <code>ModelXXX</code> to the list of functions to export, and include each of the files in <code>src/model/mXXX</code>.</li></ol><h3 id="model-sub-specifications-msubspec"><a class="docs-heading-anchor" href="#model-sub-specifications-msubspec">Model sub-specifications (<code>m.subspec</code>)</a><a id="model-sub-specifications-msubspec-1"></a><a class="docs-heading-anchor-permalink" href="#model-sub-specifications-msubspec" title="Permalink"></a></h3><p><code>Model990</code> sub-specifications are initialized by overwriting initial parameter definitions before the model object is fully constructed. This happens via a call to <code>init_subspec</code> in the <code>Model990</code> constructor. (Clearly, an identical protocol should be followed for new model types as well.)</p><p>To create a new sub-specification (e.g., subspec 1) of <code>Model990</code>, edit the file <code>src/models/subspecs.jl</code> as follows (note that this example is not actually sub-specification <code>1</code> of <code>Model990</code>. In the source code, our sub-specification <code>5</code> is provided as additional example.):</p><p><strong>Step 1.</strong> Define a new function, <code>ss1</code>, that takes an object of type <code>Model990</code> (not    <code>AbstractModel</code>!) as an argument. In this function, construct new parameter objects and    overwrite existing model parameters using the <code>&lt;=</code> syntax. For example,</p><pre><code class="language-julia">function ss1(m::Model990)
    m &lt;= parameter(:ι_w, 0.000, (0.0, .9999), (0.0,0.9999), DSGE.Untransformed(), Normal(0.0,1.0), fixed=false,
                   description=&quot;ι_w: Some description.&quot;,
                   tex_label=&quot;\\iota_w&quot;)
    m &lt;= parameter(:ι_p, 0.0, fixed=true,
                   description= &quot;ι_p: Some description&quot;
                   tex_label=&quot;\\iota_p&quot;)
end</code></pre><p><strong>Step 2.</strong> Add an <code>elseif</code> condition to <code>init_subspec</code>:</p><pre><code class="language-julia">    ...
    elseif subspec(m) == &quot;ss1&quot;
        return ss1(m)
    ...</code></pre><p>To construct an instance of <code>Model990</code>, <code>ss1</code>, call the constructor for <code>Model990</code> with <code>ss1</code> as an argument. For example,</p><pre><code class="language-julia">m = Model990(&quot;ss1&quot;)</code></pre><h2 id="Additional-Tips"><a class="docs-heading-anchor" href="#Additional-Tips">Additional Tips</a><a id="Additional-Tips-1"></a><a class="docs-heading-anchor-permalink" href="#Additional-Tips" title="Permalink"></a></h2><ul><li>The file <code>abstractdsgemodel.jl</code> defines numerous auxiliary functions, which allow the user to more easily call standard settings or count the number of dimensions for important variables. For example, <code>data_vintage(m)</code> returns the vintage of the data specified by the model object <code>m</code>. Additionally see <code>abstractmodel.jl</code> in <a href="https://github.com/FRBNY-DSGE/ModelConstructors.jl">ModelConstructors.jl</a> for more functions like <code>n_observables(m)</code>, which returns the number of observables in <code>m</code>.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../running_existing_model/">« Running An Existing Model</a><a class="docs-footer-nextpage" href="../input_data/">Input Data »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 21 December 2020 15:17">Monday 21 December 2020</span>. Using Julia version 1.1.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
